{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": [
    "config:recommended"
  ],
  "enabledManagers": [
    "custom.regex"
  ],
  "customDatasources": {
    "eks-last-supported": {
      "defaultRegistryUrlTemplate": "https://endoflife.date/api/v1/products/amazon-eks/",
      "format": "json",
      "transformTemplates": [
        /* Keep versions still in STANDARD support only */
        "{ \"releases\": [{ \"version\": $.result.releases[isEol = false]^(releaseDate)[0].name }] }"
      ]
    },
  },
  "customManagers": [
    {
      customType: 'regex',
      description: 'Track versions that have end-of-life (EOL) dates via endoflife.date',
      fileMatch: [
        '\\.rego$',
      ],
      matchStrings: [
        '#\\s*renovate:\\s*datasource=(?<datasource>.*?) depName=(?<depName>.*?)( versioning=(?<versioning>.*?))?\\s.*?_version\\s*=\\s*"(?<currentValue>.*)"',
      ]
    },
    {
      "fileMatch": [
        "(^|/)Dockerfile$",
        "(^|/)Dockerfile\\.[^/]*$"
      ],
      "matchStrings": [
        "#\\srenovate:\\sdatasource=(?<datasource>.*?)( registryUrl=(?<registryUrl>.*?))?( sourceUrl=(?<sourceUrl>.*?))? depName=(?<depName>.*?)( packageName=(?<packageName>.*?))?( versioning=(?<versioning>.*?))?( extractVersion=(?<extractVersion>.*?))?\\s*\\n(ENV|ARG) .*?_VERSION=(?<currentValue>.*)\\s"
      ]
    },
  ],
  "packageRules": [
    {
      "updateTypes": ["major", "minor"],
      "matchPackageNames": ["wiz"]
    },
  ]
}
